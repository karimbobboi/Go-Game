{"version":3,"file":"BOffcanvas.vue_vue_type_script_setup_true_lang-D1Zx4zA5.js","sources":["../src/components/BOffcanvas/BOffcanvas.vue"],"sourcesContent":["<template>\n  <ConditionalTeleport\n    :to=\"props.teleportTo\"\n    :disabled=\"props.teleportDisabled || isOpenByBreakpoint\"\n  >\n    <Transition\n      v-bind=\"transitionProps\"\n      @before-enter=\"OnBeforeEnter\"\n      @after-enter=\"OnAfterEnter\"\n      @leave=\"onLeave\"\n      @after-leave=\"OnAfterLeave\"\n    >\n      <div\n        v-show=\"modelValue || isOpenByBreakpoint\"\n        :id=\"computedId\"\n        ref=\"element\"\n        aria-modal=\"true\"\n        role=\"dialog\"\n        :class=\"computedClasses\"\n        :style=\"computedStyles\"\n        tabindex=\"-1\"\n        :aria-labelledby=\"`${computedId}-offcanvas-label`\"\n        data-bs-backdrop=\"false\"\n        v-bind=\"$attrs\"\n      >\n        <template v-if=\"lazyShowing\">\n          <div v-if=\"!props.noHeader\" class=\"offcanvas-header\" :class=\"props.headerClass\">\n            <slot name=\"header\" v-bind=\"sharedSlots\">\n              <h5 :id=\"`${computedId}-offcanvas-label`\" class=\"offcanvas-title\">\n                <slot name=\"title\" v-bind=\"sharedSlots\">\n                  {{ props.title }}\n                </slot>\n              </h5>\n              <template v-if=\"!props.noHeaderClose\">\n                <BButton v-if=\"hasHeaderCloseSlot\" v-bind=\"headerCloseAttrs\" @click=\"hide('close')\">\n                  <slot name=\"header-close\" />\n                </BButton>\n                <BCloseButton\n                  v-else\n                  :aria-label=\"props.headerCloseLabel\"\n                  v-bind=\"headerCloseAttrs\"\n                  @click=\"hide('close')\"\n                />\n              </template>\n            </slot>\n          </div>\n          <div class=\"offcanvas-body\" :class=\"props.bodyClass\" v-bind=\"props.bodyAttrs\">\n            <slot v-bind=\"sharedSlots\" />\n          </div>\n          <div v-if=\"hasFooterSlot\" :class=\"props.footerClass\">\n            <slot name=\"footer\" v-bind=\"sharedSlots\" />\n          </div>\n        </template>\n        <div\n          v-if=\"needsFallback\"\n          ref=\"fallbackFocusElement\"\n          :class=\"fallbackClassSelector\"\n          tabindex=\"0\"\n          style=\"width: 0; height: 0; overflow: hidden\"\n        />\n      </div>\n    </Transition>\n    <slot v-if=\"showBackdrop\" name=\"backdrop\">\n      <div class=\"offcanvas-backdrop fade show\" @click=\"hide('backdrop')\" />\n    </slot>\n  </ConditionalTeleport>\n</template>\n\n<script setup lang=\"ts\">\nimport {\n  breakpointsBootstrapV5,\n  onKeyStroke,\n  useBreakpoints,\n  useEventListener,\n  useFocus,\n} from '@vueuse/core'\nimport {useActivatedFocusTrap} from '../../composables/useActivatedFocusTrap'\nimport {computed, nextTick, ref, watch} from 'vue'\nimport {useDefaults} from '../../composables/useDefaults'\nimport {useId} from '../../composables/useId'\nimport type {BOffcanvasProps} from '../../types/ComponentProps'\nimport {BvTriggerableEvent} from '../../utils'\nimport BButton from '../BButton/BButton.vue'\nimport BCloseButton from '../BButton/BCloseButton.vue'\nimport ConditionalTeleport from '../ConditionalTeleport.vue'\nimport {useSafeScrollLock} from '../../composables/useSafeScrollLock'\nimport {isEmptySlot} from '../../utils/dom'\nimport type {Placement} from '../../types/Alignment'\n\n// TODO once the responsive stuff may be implemented correctly,\n// What needs to occur is a fixing of the \"body scrolling\".\n// If the offcanvas is on the screen on a large screen, body scrolling is not disabled\n// Even though the modelValue is true\n// When it's a small screen and close, it works, as normal,\n// But then when it opens up on a small screen, it must disable again\n// This is implemented on Layout.vue, but is not officially supported.\n\ndefineOptions({\n  inheritAttrs: false,\n})\n\nconst _props = withDefaults(defineProps<Omit<BOffcanvasProps, 'modelValue'>>(), {\n  hideBackdrop: false,\n  bodyAttrs: undefined,\n  bodyClass: undefined,\n  bodyScrolling: false,\n  footerClass: undefined,\n  headerClass: undefined,\n  headerCloseClass: undefined,\n  headerCloseLabel: 'Close',\n  headerCloseVariant: 'secondary',\n  id: undefined,\n  lazy: false,\n  noCloseOnBackdrop: false,\n  noCloseOnEsc: false,\n  noTrap: false,\n  noFocus: false,\n  noHeader: false,\n  noHeaderClose: false,\n  placement: 'start',\n  shadow: false,\n  teleportDisabled: false,\n  teleportTo: 'body',\n  title: undefined,\n  width: undefined,\n})\nconst props = useDefaults(_props, 'BOffcanvas')\n\nconst emit = defineEmits<{\n  'close': [value: BvTriggerableEvent]\n  'esc': [value: BvTriggerableEvent]\n  'hidden': [value: BvTriggerableEvent]\n  'hide': [value: BvTriggerableEvent]\n  'hide-prevented': []\n  'show': [value: BvTriggerableEvent]\n  'show-prevented': []\n  'shown': [value: BvTriggerableEvent]\n}>()\n\ntype SharedSlotsData = {\n  visible: boolean\n  placement: Placement\n  hide: (trigger?: string) => void\n}\n\nconst slots = defineSlots<{\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  'backdrop'?: (props: Record<string, never>) => any\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  'default'?: (props: SharedSlotsData) => any\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  'footer'?: (props: SharedSlotsData) => any\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  'header'?: (props: SharedSlotsData) => any\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  'header-close'?: (props: Record<string, never>) => any\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  'title'?: (props: SharedSlotsData) => any\n}>()\n\nconst modelValue = defineModel<Exclude<BOffcanvasProps['modelValue'], undefined>>({\n  default: false,\n})\n\nconst computedId = useId(() => props.id, 'offcanvas')\n\nconst breakpoints = useBreakpoints(breakpointsBootstrapV5)\nconst greaterOrEqualToBreakpoint = breakpoints.greaterOrEqual(() => props.responsive ?? 'xs')\nconst smallerOrEqualToBreakpoint = breakpoints.smallerOrEqual(() => props.responsive ?? 'xs')\n\nconst isOpenByBreakpoint = computed(\n  () => props.responsive !== undefined && greaterOrEqualToBreakpoint.value\n)\nuseSafeScrollLock(modelValue, () => props.bodyScrolling || isOpenByBreakpoint.value)\n\nconst element = ref<HTMLElement | null>(null)\nconst fallbackFocusElement = ref<HTMLElement | null>(null)\n\nonKeyStroke(\n  'Escape',\n  () => {\n    hide('esc')\n  },\n  {target: element}\n)\n\nconst {focused} = useFocus(element, {\n  initialValue: modelValue.value && props.noFocus === false,\n})\n\nconst isActive = ref(modelValue.value)\n\nconst fallbackClassSelector = 'offcanvas-fallback-focus'\nconst {needsFallback} = useActivatedFocusTrap({\n  element,\n  isActive,\n  noTrap: () => props.noTrap || isOpenByBreakpoint.value,\n  fallbackFocus: {\n    classSelector: fallbackClassSelector,\n    ref: fallbackFocusElement,\n  },\n})\n\nconst lazyLoadCompleted = ref(false)\nconst wasClosedByBreakpointChange = ref(false)\n\nconst showBackdrop = computed(\n  () =>\n    (props.responsive === undefined || !isOpenByBreakpoint.value) &&\n    props.hideBackdrop === false &&\n    modelValue.value === true\n)\n\nconst lazyShowing = computed(\n  () =>\n    props.lazy === false ||\n    (props.lazy === true && lazyLoadCompleted.value === true) ||\n    (props.lazy === true && modelValue.value === true)\n)\n\nconst hasHeaderCloseSlot = computed(() => !isEmptySlot(slots['header-close']))\nconst headerCloseClasses = computed(() => [\n  {'text-reset': !hasHeaderCloseSlot.value},\n  props.headerCloseClass,\n])\nconst headerCloseAttrs = computed(() => ({\n  variant: hasHeaderCloseSlot.value ? props.headerCloseVariant : undefined,\n  class: headerCloseClasses.value,\n}))\nconst transitionProps = computed(() =>\n  wasClosedByBreakpointChange.value === true\n    ? null\n    : {\n        enterToClass: 'showing',\n        enterFromClass: '',\n        leaveToClass: 'hiding show',\n        leaveFromClass: 'show',\n      }\n)\n\nconst hasFooterSlot = computed(() => !isEmptySlot(slots.footer))\nconst computedClasses = computed(() => [\n  props.responsive === undefined ? 'offcanvas' : `offcanvas-${props.responsive}`,\n  `offcanvas-${props.placement}`,\n  {\n    show: modelValue.value && isActive.value === true,\n    [`shadow-${props.shadow}`]: !!props.shadow,\n  },\n])\n\nconst computedStyles = computed(() => ({\n  width: props.width,\n}))\n\nconst sharedSlots = computed<SharedSlotsData>(() => ({\n  visible: modelValue.value,\n  placement: props.placement,\n  hide,\n}))\n\nconst buildTriggerableEvent = (\n  type: string,\n  opts: Partial<BvTriggerableEvent> = {}\n): BvTriggerableEvent =>\n  new BvTriggerableEvent(type, {\n    cancelable: false,\n    target: element.value || null,\n    relatedTarget: null,\n    trigger: null,\n    ...opts,\n    componentId: computedId.value,\n  })\n\nconst hide = (trigger = '') => {\n  if (\n    (trigger === 'backdrop' && props.noCloseOnBackdrop) ||\n    (trigger === 'esc' && props.noCloseOnEsc)\n  ) {\n    emit('hide-prevented')\n    return\n  }\n\n  const event = buildTriggerableEvent('hide', {cancelable: trigger !== '', trigger})\n\n  if (trigger === 'close') {\n    emit(trigger, event)\n  }\n  if (trigger === 'esc') {\n    emit(trigger, event)\n  }\n  emit('hide', event)\n\n  if (event.defaultPrevented) {\n    emit('hide-prevented')\n    return\n  }\n\n  modelValue.value = false\n}\n\nconst show = () => {\n  const event = buildTriggerableEvent('show', {cancelable: true})\n  emit('show', event)\n  if (event.defaultPrevented) {\n    modelValue.value = false\n    emit('show-prevented')\n    return\n  }\n  modelValue.value = true\n}\n\nconst focus = () => {\n  nextTick(() => {\n    if (props.noFocus === false) {\n      focused.value = true\n    }\n  })\n}\n\nconst OnBeforeEnter = () => show()\nconst OnAfterEnter = () => {\n  isActive.value = true\n  focus()\n  emit('shown', buildTriggerableEvent('shown'))\n  if (props.lazy === true) lazyLoadCompleted.value = true\n}\nconst onLeave = () => {\n  wasClosedByBreakpointChange.value = false\n  isActive.value = false\n}\nconst OnAfterLeave = () => {\n  emit('hidden', buildTriggerableEvent('hidden'))\n  if (props.lazy === true) lazyLoadCompleted.value = false\n}\nuseEventListener(element, 'bv-toggle', () => {\n  modelValue.value ? hide() : show()\n})\n\nwatch(greaterOrEqualToBreakpoint, (newValue) => {\n  if (props.responsive === undefined) return\n  modelValue.value = newValue\n})\nwatch(smallerOrEqualToBreakpoint, (newValue) => {\n  if (props.responsive === undefined && newValue === true) return\n  wasClosedByBreakpointChange.value = true\n})\n\ndefineExpose({\n  hide,\n  show,\n})\n</script>\n"],"names":["fallbackClassSelector","_props","__props","props","useDefaults","emit","__emit","slots","_useSlots","modelValue","_useModel","computedId","useId","id","breakpoints","useBreakpoints","breakpointsBootstrapV5","greaterOrEqualToBreakpoint","greaterOrEqual","responsive","smallerOrEqualToBreakpoint","smallerOrEqual","isOpenByBreakpoint","computed","value","useSafeScrollLock","bodyScrolling","element","ref","fallbackFocusElement","index","onKeyStroke","hide","target","focused","useFocus","initialValue","noFocus","isActive","needsFallback","useActivatedFocusTrap","noTrap","fallbackFocus","classSelector","lazyLoadCompleted","wasClosedByBreakpointChange","showBackdrop","hideBackdrop","lazyShowing","lazy","hasHeaderCloseSlot","isEmptySlot","headerCloseClasses","headerCloseClass","headerCloseAttrs","variant","headerCloseVariant","class","transitionProps","enterToClass","enterFromClass","leaveToClass","leaveFromClass","hasFooterSlot","footer","computedClasses","placement","show","shadow","computedStyles","width","sharedSlots","visible","buildTriggerableEvent","type","opts","BvTriggerableEvent","cancelable","relatedTarget","trigger","componentId","noCloseOnBackdrop","noCloseOnEsc","event","defaultPrevented","OnBeforeEnter","OnAfterEnter","nextTick","onLeave","OnAfterLeave","newValue","__expose"],"mappings":"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"}