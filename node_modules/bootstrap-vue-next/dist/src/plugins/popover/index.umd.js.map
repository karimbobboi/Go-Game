{"version":3,"file":"index.umd.js","sources":["../../../../src/plugins/popover/index.ts"],"sourcesContent":["import {markRaw, type Plugin, ref, toRef, watch} from 'vue'\nimport {popoverPluginKey} from '../../utils/keys'\nimport type {\n  PopoverOrchestratorMapValue,\n  PopoverOrchestratorShowParam,\n  PrivateOrchestratedPopover,\n} from '../../types/ComponentOrchestratorTypes'\n\nexport const popoverPlugin: Plugin = {\n  install(app) {\n    const popovers = ref(new Map<symbol, PopoverOrchestratorMapValue>())\n\n    /**\n     * @returns {symbol} A symbol that corresponds to its unique id. You can pass this id to the hide function to force a Toast to hide\n     */\n    const show = (obj: PopoverOrchestratorShowParam): symbol => {\n      const resolvedProps = toRef(obj.props)\n\n      const _self = Symbol()\n\n      watch(\n        obj.ref,\n        (newValue) => {\n          if (!newValue) {\n            popovers.value.delete(_self)\n          } else {\n            popovers.value.set(_self, {\n              component: !obj.component ? undefined : markRaw(obj.component),\n              props: {...resolvedProps.value, _reference: newValue, _modelValue: false},\n            })\n          }\n        },\n        {immediate: true}\n      )\n\n      watch(resolvedProps, (newValue) => {\n        const previous = popovers.value.get(_self)\n        if (!previous) return\n        popovers.value.set(_self, {\n          component: !obj.component ? undefined : markRaw(obj.component),\n          props: {...previous.props, ...newValue},\n        })\n      })\n\n      return _self\n    }\n\n    /**\n     * You can get the symbol param from the return value from the show method\n     */\n    const remove = (self: symbol) => {\n      popovers.value.delete(self)\n    }\n\n    const set = (self: symbol, val: Partial<PrivateOrchestratedPopover>) => {\n      const popover = popovers.value.get(self)\n      if (!popover?.props) return\n      popover.props = {\n        ...popover.props,\n        ...val,\n      }\n    }\n\n    app.provide(popoverPluginKey, {\n      popovers,\n      show,\n      remove,\n      set,\n    })\n  },\n}\n"],"names":["popoverPlugin","install","app","popovers","ref","Map","provide","popoverPluginKey","show","obj","resolvedProps","toRef","props","_self","Symbol","vue","watch","newValue","value","set","component","markRaw","_reference","_modelValue","delete","immediate","previous","get","remove","self","val","popover"],"mappings":"8IAQaA,EAAwB,CACnC,OAAAC,CAAQC,GACN,MAAMC,EAAWC,EAAAA,IAAQ,IAAAC,KAqDrBH,EAAAI,QAAQC,mBAAkB,CAC5BJ,WACAK,KAlDYC,IACN,MAAAC,EAAgBC,EAAAA,MAAMF,EAAIG,OAE1BC,EAAQC,SA0BP,OAxBPC,EAAAC,MACEP,EAAIL,KACHa,IACMA,EAGMd,EAAAe,MAAMC,IAAIN,EAAO,CACxBO,UAAYX,EAAIW,UAAwBC,EAAAA,QAAQZ,EAAIW,gBAAxB,EAC5BR,MAAO,IAAIF,EAAcQ,MAAOI,WAAYL,EAAUM,aAAa,KAJ5DpB,EAAAe,MAAMM,OAAOX,EAMxB,GAEF,CAACY,WAAW,YAGRf,GAAgBO,IACpB,MAAMS,EAAWvB,EAASe,MAAMS,IAAId,GAC/Ba,GACIvB,EAAAe,MAAMC,IAAIN,EAAO,CACxBO,UAAYX,EAAIW,UAAwBC,EAAAA,QAAQZ,EAAIW,gBAAxB,EAC5BR,MAAO,IAAIc,EAASd,SAAUK,IAC/B,IAGIJ,CAAA,EAsBPe,OAhBcC,IACL1B,EAAAe,MAAMM,OAAOK,EAAI,EAgB1BV,IAbU,CAACU,EAAcC,KACzB,MAAMC,EAAU5B,EAASe,MAAMS,IAAIE,UAC9BE,WAASnB,SACdmB,EAAQnB,MAAQ,IACXmB,EAAQnB,SACRkB,GAAA,GAUT"}