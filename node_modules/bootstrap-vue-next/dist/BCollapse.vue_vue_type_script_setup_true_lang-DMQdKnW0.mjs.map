{"version":3,"file":"BCollapse.vue_vue_type_script_setup_true_lang-DMQdKnW0.mjs","sources":["../src/components/BCollapse/BCollapse.vue"],"sourcesContent":["<template>\n  <slot name=\"header\" v-bind=\"sharedSlots\" />\n  <component\n    :is=\"props.tag\"\n    :id=\"computedId\"\n    ref=\"element\"\n    class=\"collapse\"\n    :class=\"computedClasses\"\n    :is-nav=\"props.isNav\"\n    v-bind=\"$attrs\"\n  >\n    <slot v-bind=\"sharedSlots\" />\n  </component>\n  <slot name=\"footer\" v-bind=\"sharedSlots\" />\n</template>\n\n<script setup lang=\"ts\">\nimport {computed, nextTick, onMounted, provide, readonly, ref, toRef, watch} from 'vue'\nimport {useDefaults} from '../../composables/useDefaults'\nimport {useId} from '../../composables/useId'\nimport {useEventListener} from '@vueuse/core'\nimport {collapseInjectionKey} from '../../utils/keys'\nimport type {BCollapseProps} from '../../types/ComponentProps'\nimport {BvTriggerableEvent} from '../../utils'\nimport {getTransitionDelay} from '../../utils/dom'\n\ndefineOptions({\n  inheritAttrs: false,\n})\n\nconst _props = withDefaults(defineProps<Omit<BCollapseProps, 'modelValue'>>(), {\n  horizontal: false,\n  id: undefined,\n  isNav: false,\n  skipAnimation: false,\n  tag: 'div',\n  toggle: false,\n  visible: false,\n})\n\nconst props = useDefaults(_props, 'BCollapse')\n\nconst emit = defineEmits<{\n  'hidden': []\n  'hide': [value: BvTriggerableEvent]\n  'hide-prevented': []\n  'show': [value: BvTriggerableEvent]\n  'show-prevented': []\n  'shown': []\n}>()\n\ntype SharedSlotsData = {\n  hide: () => void\n  id: string\n  show: () => void\n  toggle: () => void\n  visible: boolean\n}\n\ndefineSlots<{\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  default?: (props: SharedSlotsData) => any\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  footer?: (props: SharedSlotsData) => any\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  header?: (props: SharedSlotsData) => any\n}>()\n\nconst buildTriggerableEvent = (\n  type: string,\n  opts: Readonly<Partial<BvTriggerableEvent>> = {}\n): BvTriggerableEvent =>\n  new BvTriggerableEvent(type, {\n    cancelable: false,\n    target: element.value || null,\n    relatedTarget: null,\n    trigger: null,\n    ...opts,\n    componentId: computedId.value,\n  })\n\nconst modelValue = defineModel<Exclude<BCollapseProps['modelValue'], undefined>>({\n  default: false,\n})\n\nconst computedId = useId(() => props.id, 'collapse')\n\nconst element = ref<HTMLElement | null>(null)\nconst isCollapsing = ref(false)\nconst showRef = ref(modelValue.value)\n\nconst computedClasses = computed(() => ({\n  'show': showRef.value,\n  'navbar-collapse': props.isNav,\n  'collapsing': isCollapsing.value,\n  'closing': showRef.value && !modelValue.value,\n  'collapse-horizontal': props.horizontal,\n}))\n\nconst hide = () => {\n  modelValue.value = false\n}\nconst show = () => {\n  modelValue.value = true\n}\nconst toggleFn = () => {\n  modelValue.value = !modelValue.value\n}\n\nconst sharedSlots = computed<SharedSlotsData>(() => ({\n  toggle: toggleFn,\n  show,\n  hide,\n  id: computedId.value,\n  visible: modelValue.value,\n}))\n\nlet revealTimeout: ReturnType<typeof setTimeout> | undefined\nlet hideTimeout: ReturnType<typeof setTimeout> | undefined\nlet _skipAnimation = props.skipAnimation\n\nconst reveal = () => {\n  const event = buildTriggerableEvent('show', {cancelable: true})\n  emit('show', event)\n  if (event.defaultPrevented) {\n    emit('show-prevented')\n    return\n  }\n  clearTimeout(hideTimeout)\n  clearTimeout(revealTimeout)\n  showRef.value = true\n  if (_skipAnimation) return\n  isCollapsing.value = true\n  nextTick(() => {\n    if (element.value === null) return\n    if (props.horizontal) {\n      element.value.style.width = `${element.value.scrollWidth}px`\n    } else {\n      element.value.style.height = `${element.value.scrollHeight}px`\n    }\n    revealTimeout = setTimeout(() => {\n      isCollapsing.value = false\n      emit('shown')\n      if (element.value === null) return\n      element.value.style.height = ''\n      element.value.style.width = ''\n    }, getTransitionDelay(element.value))\n  })\n}\n\nconst hideFn = () => {\n  const event = buildTriggerableEvent('hide', {cancelable: true})\n  emit('hide', event)\n  if (event.defaultPrevented) {\n    emit('hide-prevented')\n    return\n  }\n  clearTimeout(revealTimeout)\n  clearTimeout(hideTimeout)\n  if (element.value === null) return\n  if (_skipAnimation) {\n    showRef.value = false\n    return\n  }\n  if (isCollapsing.value) {\n    element.value.style.height = ``\n    element.value.style.width = ``\n    // return\n  } else {\n    if (props.horizontal) {\n      element.value.style.width = `${element.value.scrollWidth}px`\n    } else {\n      element.value.style.height = `${element.value.scrollHeight}px`\n    }\n  }\n  // element.value.style.height = `${element.value.scrollHeight}px`\n  element.value.offsetHeight // force reflow\n  isCollapsing.value = true\n  nextTick(() => {\n    if (element.value === null) return\n    element.value.style.height = ``\n    element.value.style.width = ``\n    hideTimeout = setTimeout(() => {\n      showRef.value = false\n      isCollapsing.value = false\n      emit('hidden')\n    }, getTransitionDelay(element.value))\n  })\n}\n\nwatch(modelValue, () => {\n  modelValue.value ? reveal() : hideFn()\n})\n\nonMounted(() => {\n  if (element.value === null) return\n  if (!modelValue.value && props.toggle) {\n    nextTick(() => {\n      modelValue.value = true\n    })\n  }\n})\n\nwatch(\n  () => props.skipAnimation,\n  (newval) => {\n    _skipAnimation = newval\n  }\n)\n\nif (props.visible) {\n  _skipAnimation = true\n  modelValue.value = true\n  nextTick(() => {\n    _skipAnimation = props.skipAnimation\n  })\n}\n\nwatch(\n  () => props.visible,\n  (newval) => {\n    _skipAnimation = true\n    newval ? show() : hide()\n    nextTick(() => {\n      _skipAnimation = props.skipAnimation\n    })\n  }\n)\n\nuseEventListener(element, 'bv-toggle', () => {\n  modelValue.value = !modelValue.value\n})\n\ndefineExpose({\n  hide,\n  isNav: props.isNav,\n  show,\n  toggle: toggleFn,\n  visible: readonly(showRef),\n})\n\nprovide(collapseInjectionKey, {\n  id: computedId,\n  hide,\n  show,\n  toggle: toggleFn,\n  visible: readonly(showRef),\n  isNav: toRef(() => props.isNav),\n})\n</script>\n"],"names":["_useModel"],"mappings":"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"}