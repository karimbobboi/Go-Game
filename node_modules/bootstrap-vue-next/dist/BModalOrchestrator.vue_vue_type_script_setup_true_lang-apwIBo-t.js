"use strict";const e=require("vue"),a=require("./useDefaults-C2groUjC.js"),l=require("./index-CnY1um_J.js"),o=require("./useSafeScrollLock-DoX-OOqc.js"),t=require("./classes-CXBJXuVd.js"),r=require("./BButton.vue_vue_type_script_setup_true_lang-sjMGFjGE.js"),n=require("./BCloseButton.vue_vue_type_script_setup_true_lang-CRwsufrO.js"),d=require("./useId-D-t4Y3Sk.js"),s=require("./dom-C-F8jHop.js"),u=require("./useColorVariantClasses-CE658Sm0.js"),i=require("./useModalManager-M-dZHVBe.js"),c=require("./ConditionalTeleport.vue_vue_type_script_lang-nP1ZUfLS.js"),f=require("./_plugin-vue_export-helper-CC_fc8JW.js"),p=require("./src/composables/useModalController/index.umd.js"),v=["id","aria-labelledby","aria-describedby"],m=["id"],y="modal-fallback-focus",B=e.defineComponent({inheritAttrs:!1,__name:"BModal",props:e.mergeModels({autofocus:{type:Boolean,default:!0},autofocusButton:{default:void 0},body:{default:void 0},bodyAttrs:{default:void 0},bodyBgVariant:{default:null},bodyClass:{default:null},bodyScrolling:{type:Boolean,default:!1},bodyTextVariant:{default:null},bodyVariant:{default:null},busy:{type:Boolean,default:!1},buttonSize:{default:"md"},cancelDisabled:{type:Boolean,default:!1},cancelTitle:{default:"Cancel"},cancelVariant:{default:"secondary"},centered:{type:Boolean,default:!1},contentClass:{default:void 0},dialogClass:{default:void 0},footerBgVariant:{default:null},footerBorderVariant:{default:null},footerClass:{default:void 0},footerTextVariant:{default:null},footerVariant:{default:null},fullscreen:{type:[Boolean,String],default:!1},headerBgVariant:{default:null},headerBorderVariant:{default:null},headerClass:{default:void 0},headerCloseClass:{default:void 0},headerCloseLabel:{default:"Close"},headerCloseVariant:{default:"secondary"},headerTextVariant:{default:null},headerVariant:{default:null},hideBackdrop:{type:Boolean,default:!1},hideFooter:{type:Boolean,default:!1},hideHeader:{type:Boolean,default:!1},hideHeaderClose:{type:Boolean,default:!1},id:{default:void 0},lazy:{type:Boolean,default:!1},modalClass:{default:void 0},noCloseOnBackdrop:{type:Boolean,default:!1},noCloseOnEsc:{type:Boolean,default:!1},noFade:{type:Boolean,default:!1},noTrap:{type:Boolean,default:!1},noStacking:{type:Boolean},okDisabled:{type:Boolean,default:!1},okOnly:{type:Boolean,default:!1},okTitle:{default:"OK"},okVariant:{default:"primary"},scrollable:{type:Boolean,default:!1},size:{default:"md"},title:{default:void 0},titleClass:{default:void 0},titleSrOnly:{type:Boolean,default:!1},titleTag:{default:"h5"},transProps:{default:void 0},teleportDisabled:{type:Boolean,default:!1},teleportTo:{default:"body"}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:e.mergeModels(["backdrop","cancel","close","esc","hidden","hide","hide-prevented","ok","show","show-prevented","shown"],["update:modelValue"]),setup(f,{expose:p,emit:B}){const b=f,k=a.useDefaults(b,"BModal"),C=B,h=e.useSlots(),g=d.useId((()=>k.id),"modal"),V=e.useModel(f,"modelValue"),_=e.ref(null),S=e.ref(null),w=e.ref(null),x=e.ref(null),T=e.ref(null),z=e.ref(!1),P=e.ref(!1),{needsFallback:E}=o.useActivatedFocusTrap({element:_,isActive:z,noTrap:()=>k.noTrap,fallbackFocus:{ref:S,classSelector:y}}),D=(N=!0,e.computed((()=>{const a={name:"",enterActiveClass:"",enterToClass:"",leaveActiveClass:"",leaveToClass:"showing",enterFromClass:"showing",leaveFromClass:"",css:!0},l={...a,name:"fade",enterActiveClass:"fade showing",leaveActiveClass:"fade showing"};return e.toValue(N)?a:l})));var N;l.onKeyStroke("Escape",(()=>{Z("esc")}),{target:_}),o.useSafeScrollLock(V,(()=>k.bodyScrolling));const{focused:F}=l.useFocus(_,{initialValue:V.value&&void 0===k.autofocusButton&&!0===k.autofocus}),{focused:M}=l.useFocus(w,{initialValue:V.value&&"ok"===k.autofocusButton&&!0===k.autofocus}),{focused:$}=l.useFocus(x,{initialValue:V.value&&"cancel"===k.autofocusButton&&!0===k.autofocus}),{focused:q}=l.useFocus(T,{initialValue:V.value&&"close"===k.autofocusButton&&!0===k.autofocus}),j=e.computed((()=>[k.modalClass,{fade:!k.noFade,show:z.value}])),A=e.computed((()=>!1===k.lazy||!0===k.lazy&&!0===P.value||!0===k.lazy&&!0===V.value)),O=e.computed((()=>!s.isEmptySlot(h["header-close"]))),H=e.computed((()=>[k.dialogClass,{"modal-fullscreen":!0===k.fullscreen,[`modal-fullscreen-${k.fullscreen}-down`]:"string"==typeof k.fullscreen,[`modal-${k.size}`]:"md"!==k.size,"modal-dialog-centered":k.centered,"modal-dialog-scrollable":k.scrollable}])),L=u.useColorVariantClasses((()=>({bgVariant:k.bodyBgVariant,textVariant:k.bodyTextVariant,variant:k.bodyVariant}))),R=e.computed((()=>[k.bodyClass,L.value])),I=u.useColorVariantClasses((()=>({bgVariant:k.headerBgVariant,textVariant:k.headerTextVariant,variant:k.headerVariant,borderVariant:k.headerBorderVariant}))),K=e.computed((()=>[k.headerClass,I.value])),U=e.computed((()=>({variant:O.value?k.headerCloseVariant:void 0,class:k.headerCloseClass}))),W=u.useColorVariantClasses((()=>({bgVariant:k.footerBgVariant,textVariant:k.footerTextVariant,variant:k.footerVariant,borderVariant:k.footerBorderVariant}))),X=e.computed((()=>[k.footerClass,W.value])),Y=e.computed((()=>[k.titleClass,{"visually-hidden":k.titleSrOnly}])),G=e.computed((()=>k.cancelDisabled||k.busy)),J=e.computed((()=>k.okDisabled||k.busy)),Q=(e,a={})=>new t.BvTriggerableEvent(e,{cancelable:!1,target:_.value||null,relatedTarget:null,trigger:null,...a,componentId:g.value});e.watch(V,((e,a)=>{e!==a&&(!0===e?ee():Z())}));const Z=(e="")=>{if("backdrop"===e&&k.noCloseOnBackdrop||"esc"===e&&k.noCloseOnEsc)return void C("hide-prevented");const a=Q("hide",{cancelable:""!==e,trigger:e});if("ok"===e&&C(e,a),"cancel"===e&&C(e,a),"close"===e&&C(e,a),"backdrop"===e&&C(e,a),"esc"===e&&C(e,a),C("hide",a),a.defaultPrevented)return C("hide-prevented"),void(V.value||(V.value=!0));V.value&&(V.value=!1)},ee=()=>{if(z.value)return;const e=Q("show",{cancelable:!0});if(C("show",e),e.defaultPrevented)return V.value&&(V.value=!1),void C("show-prevented");V.value||(V.value=!0)},ae=()=>{ee()},le=()=>{z.value=!0,!1!==k.autofocus&&("ok"===k.autofocusButton?M.value=!0:"close"===k.autofocusButton?q.value=!0:"cancel"===k.autofocusButton?$.value=!0:F.value=!0),C("shown",Q("shown")),!0===k.lazy&&(P.value=!0)},oe=e.ref(!1),te=()=>{z.value=!1,oe.value=!0},re=()=>{C("hidden",Q("hidden")),!0===k.lazy&&(P.value=!1),oe.value=!1},{activePosition:ne,activeModalCount:de,stackWithoutSelf:se}=i.useModalManager(z,V.value);e.watch(se,((e,a)=>{e.length>a.length&&!0===z.value&&!0===k.noStacking&&Z()}));const ue=e.computed((()=>({"z-index":z.value||oe.value?1056-(((null==de?void 0:de.value)??0)-((null==ne?void 0:ne.value)??0)):1056})));l.useEventListener(_,"bv-toggle",(()=>{V.value?Z():ee()}));const ie=e.computed((()=>({cancel:()=>{Z("cancel")},close:()=>{Z("close")},hide:Z,ok:()=>{Z("ok")},active:z.value,visible:V.value})));return p({hide:Z,id:g,show:ee}),(a,l)=>(e.openBlock(),e.createBlock(c._sfc_main,{to:e.unref(k).teleportTo,disabled:e.unref(k).teleportDisabled},{default:e.withCtx((()=>[e.createVNode(e.Transition,e.mergeProps({...e.unref(D),...e.unref(k).transProps,enterToClass:"show"},{appear:V.value,onBeforeEnter:ae,onAfterEnter:le,onLeave:te,onAfterLeave:re}),{default:e.withCtx((()=>[e.withDirectives(e.createElementVNode("div",e.mergeProps({id:e.unref(g),ref_key:"element",ref:_,class:["modal",j.value],role:"dialog","aria-labelledby":e.unref(k).hideHeader?void 0:`${e.unref(g)}-label`,"aria-describedby":`${e.unref(g)}-body`,tabindex:"-1"},a.$attrs,{style:ue.value}),[e.createElementVNode("div",{class:e.normalizeClass(["modal-dialog",H.value])},[A.value?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["modal-content",e.unref(k).contentClass])},[e.unref(k).hideHeader?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["modal-header",K.value])},[e.renderSlot(a.$slots,"header",e.normalizeProps(e.guardReactiveProps(ie.value)),(()=>[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(k).titleTag),{id:`${e.unref(g)}-label`,class:e.normalizeClass(["modal-title",Y.value])},{default:e.withCtx((()=>[e.renderSlot(a.$slots,"title",e.normalizeProps(e.guardReactiveProps(ie.value)),(()=>[e.createTextVNode(e.toDisplayString(e.unref(k).title),1)]),!0)])),_:3},8,["id","class"])),e.unref(k).hideHeaderClose?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[O.value?(e.openBlock(),e.createBlock(r._sfc_main,e.mergeProps({key:0},U.value,{onClick:l[0]||(l[0]=e=>Z("close"))}),{default:e.withCtx((()=>[e.renderSlot(a.$slots,"header-close",{},void 0,!0)])),_:3},16)):(e.openBlock(),e.createBlock(n._sfc_main,e.mergeProps({key:1,"aria-label":e.unref(k).headerCloseLabel},U.value,{onClick:l[1]||(l[1]=e=>Z("close"))}),null,16,["aria-label"]))],64))]),!0)],2)),e.createElementVNode("div",e.mergeProps({id:`${e.unref(g)}-body`,class:["modal-body",R.value]},e.unref(k).bodyAttrs),[e.renderSlot(a.$slots,"default",e.normalizeProps(e.guardReactiveProps(ie.value)),(()=>[e.createTextVNode(e.toDisplayString(e.unref(k).body),1)]),!0)],16,m),e.unref(k).hideFooter?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:1,class:e.normalizeClass(["modal-footer",X.value])},[e.renderSlot(a.$slots,"footer",e.normalizeProps(e.guardReactiveProps(ie.value)),(()=>[e.renderSlot(a.$slots,"cancel",e.normalizeProps(e.guardReactiveProps(ie.value)),(()=>[e.unref(k).okOnly?e.createCommentVNode("",!0):(e.openBlock(),e.createBlock(r._sfc_main,{key:0,ref_key:"cancelButton",ref:x,disabled:G.value,size:e.unref(k).buttonSize,variant:e.unref(k).cancelVariant,onClick:l[2]||(l[2]=e=>Z("cancel"))},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(e.unref(k).cancelTitle),1)])),_:1},8,["disabled","size","variant"]))]),!0),e.renderSlot(a.$slots,"ok",e.normalizeProps(e.guardReactiveProps(ie.value)),(()=>[e.createVNode(r._sfc_main,{ref_key:"okButton",ref:w,disabled:J.value,size:e.unref(k).buttonSize,variant:e.unref(k).okVariant,onClick:l[3]||(l[3]=e=>Z("ok"))},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(e.unref(k).okTitle),1)])),_:1},8,["disabled","size","variant"])]),!0)]),!0)],2))],2)):e.createCommentVNode("",!0)],2),e.unref(k).hideBackdrop?e.createCommentVNode("",!0):e.renderSlot(a.$slots,"backdrop",e.normalizeProps(e.mergeProps({key:0},ie.value)),(()=>[e.createElementVNode("div",{class:"modal-backdrop fade show",onClick:l[4]||(l[4]=e=>Z("backdrop"))})]),!0),e.unref(E)?(e.openBlock(),e.createElementBlock("div",{key:1,ref_key:"fallbackFocusElement",ref:S,class:e.normalizeClass(y),tabindex:"0",style:{width:"0",height:"0",overflow:"hidden"}},null,512)):e.createCommentVNode("",!0)],16,v),[[e.vShow,V.value]])])),_:3},16,["appear"])])),_:3},8,["to","disabled"]))}}),b=f._export_sfc(B,[["__scopeId","data-v-b05df8ad"]]),k=e.defineComponent({inheritAttrs:!1,__name:"BModalOrchestrator",props:{teleportDisabled:{type:Boolean,default:!1},teleportTo:{default:"body"}},setup(l,{expose:o}){const t=l,r=a.useDefaults(t,"BModalOrchestrator"),n=p.useModalController();return o({...n}),(a,l)=>(e.openBlock(),e.createBlock(c._sfc_main,{to:e.unref(r).teleportTo,disabled:e.unref(r).teleportDisabled},{default:e.withCtx((()=>{var l;return[e.createElementVNode("div",e.mergeProps({id:"__BVID__modal-container"},a.$attrs),[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(null==(l=e.unref(n).modals)?void 0:l.value,(([a,l])=>(e.openBlock(),e.createBlock(e.resolveDynamicComponent(l.component??b),e.mergeProps({key:a,ref_for:!0},l.props,{modelValue:l.props._modelValue,"onUpdate:modelValue":[e=>l.props._modelValue=e,l=>{var o,t;return null==(t=(o=e.unref(n)).leave)?void 0:t.call(o,a)}],"teleport-disabled":!0,onHide:e=>{if(!0===l.props._isConfirm){if("ok"===e.trigger)return void l.props._promise.resolve(!0);if("cancel"===e.trigger)return void l.props._promise.resolve(!1);l.props._promise.resolve(null)}l.props._promise.resolve(!0)},onHidden:l=>{var o,t;return null==(t=(o=e.unref(n)).remove)?void 0:t.call(o,a)}}),null,16,["modelValue","onUpdate:modelValue","onHide","onHidden"])))),128))],16)]})),_:1},8,["to","disabled"]))}});exports.BModal=b,exports._sfc_main=k;
//# sourceMappingURL=BModalOrchestrator.vue_vue_type_script_setup_true_lang-apwIBo-t.js.map
