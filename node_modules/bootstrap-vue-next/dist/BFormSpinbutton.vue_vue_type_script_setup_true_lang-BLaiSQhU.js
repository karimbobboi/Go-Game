"use strict";const e=require("vue"),a=require("./event-DqyBZX_g.js"),t=require("./constants-Caz6vMlV.js"),l=require("./index-CnY1um_J.js"),o=require("./useDefaults-C2groUjC.js"),u=require("./useId-D-t4Y3Sk.js"),r=require("./keys-Dkmt9nlW.js"),n=require("./index-BInTFWT4.js"),i=["lang","tabindex","title"],d=["name","form","value"],s=["id","dir","tabindex","aria-label","aria-invalid","aria-required","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext"],v=1,m=100,c=1,p=500,b=100,f=10,h=4,y=e.defineComponent({__name:"BFormSpinbutton",props:e.mergeModels({ariaControls:{default:void 0},ariaLabel:{default:void 0},disabled:{type:Boolean,default:!1},form:{default:void 0},formatterFn:{type:Function,default:void 0},id:{default:void 0},inline:{type:Boolean,default:!1},labelDecrement:{default:"Decrement"},labelIncrement:{default:"Increment"},locale:{default:void 0},max:{default:m},min:{default:v},name:{default:void 0},placeholder:{default:void 0},readonly:{type:Boolean,default:!1},repeatDelay:{default:p},repeatInterval:{default:b},repeatStepMultiplier:{default:h},repeatThreshold:{default:f},required:{type:Boolean,default:!1},size:{default:void 0},state:{type:[Boolean,null],default:null},step:{default:c},vertical:{type:Boolean,default:!1},wrap:{type:Boolean,default:!1}},{modelValue:{default:null},modelModifiers:{}}),emits:e.mergeModels(["change"],["update:modelValue"]),setup(m,{emit:y}){const g=[t.CODE_UP,t.CODE_DOWN,t.CODE_HOME,t.CODE_END,t.CODE_PAGEUP,t.CODE_PAGEDOWN],N=m,D=o.useDefaults(N,"BFormSpinbutton"),E=y,w=e.useModel(m,"modelValue"),x=e.ref(null),{focused:O}=l.useFocus(x),C=u.useId((()=>D.id),"spinbutton"),P=e.computed((()=>({disabled:D.disabled,readonly:D.readonly,focus:O.value,"d-inline-flex":D.inline||D.vertical,"d-flex":!D.inline&&!D.vertical,"align-items-stretch":!D.vertical,"flex-column":D.vertical,[`form-control-${D.size}`]:void 0!==D.size}))),M=e.computed((()=>({"d-flex":D.vertical,"align-self-center":!D.vertical,"align-items-center":D.vertical,"border-top":D.vertical,"border-bottom":D.vertical,"border-start":!D.vertical,"border-end":!D.vertical})));let _,k,B=!1;const I=n.useToNumber((()=>D.step)),T=e.computed((()=>Number.isNaN(I.value)?c:I.value)),q=n.useToNumber((()=>D.min)),F=e.computed((()=>Number.isNaN(q.value)?v:q.value)),z=n.useToNumber((()=>D.max)),A=e.computed((()=>{const e=T.value,a=F.value;return Math.floor((z.value-a)/e)*e+a})),S=n.useToNumber((()=>D.repeatDelay),{nanToZero:!0,method:"parseInt"}),V=e.computed((()=>S.value>0?S.value:p)),j=n.useToNumber((()=>D.repeatInterval),{nanToZero:!0,method:"parseInt"}),K=e.computed((()=>j.value>0?j.value:b)),R=n.useToNumber((()=>D.repeatThreshold),{nanToZero:!0,method:"parseInt"}),U=e.computed((()=>Math.max(Number.isNaN(R.value)?f:R.value,1))),W=n.useToNumber((()=>D.repeatStepMultiplier),{nanToZero:!0,method:"parseInt"}),G=e.computed((()=>Math.max(Number.isNaN(W.value)?h:W.value,1))),Z=e.computed((()=>{const e=T.value;return Math.floor(e)===e?0:(e.toString().split(".")[1]||"").length})),L=e.computed((()=>Math.pow(10,Z.value||0))),$=e.computed((()=>null===w.value?"":w.value.toFixed(Z.value))),{isRtl:H,locale:X}=(()=>{const a=e.inject(r.rtlPluginKey);return e.onMounted((()=>{e.watch((()=>null==a?void 0:a.locale.value),(e=>{document.documentElement.setAttribute("lang",e??"")}),{immediate:!0}),e.watch((()=>null==a?void 0:a.isRtl.value),(e=>{document.documentElement.setAttribute("dir",e?"rtl":"ltr")}),{immediate:!0})})),{...a}})(),J=e.computed((()=>{const e=[(D.locale??(null==X?void 0:X.value))||"locale"];return new Intl.NumberFormat(e).resolvedOptions().locale})),Q=e.computed((()=>D.formatterFn??new Intl.NumberFormat(J.value,{style:"decimal",useGrouping:!1,minimumIntegerDigits:1,minimumFractionDigits:Z.value,maximumFractionDigits:Z.value,notation:"standard"}).format)),Y=e=>{let{value:a}=w;if(!D.disabled&&null!==a){const t=T.value*e,l=F.value,o=A.value,u=L.value,{wrap:r}=D;a=Math.round((a-l)/t)*t+l+t,a=Math.round(a*u)/u,w.value=a>o?r?l:o:a<l?r?o:l:a}},ee=(e=1)=>{null!==w.value?Y(1*e):w.value=F.value},ae=(e=1)=>{null!==w.value?Y(-1*e):w.value=D.wrap?A.value:F.value},te=e=>{e.preventDefault(),e.stopImmediatePropagation()};l.onKeyStroke(g,(e=>{const{code:a,altKey:l,ctrlKey:o,metaKey:u}=e;if(!(D.disabled||D.readonly||l||o||u||(te(e),B))){if(ne(),[t.CODE_UP,t.CODE_DOWN].includes(a))return B=!0,a===t.CODE_UP?void le(e,ee):void(a===t.CODE_DOWN&&le(e,ae));a!==t.CODE_PAGEUP?a!==t.CODE_PAGEDOWN?a!==t.CODE_HOME?a===t.CODE_END&&(w.value=A.value):w.value=F.value:ae(G.value):ee(G.value)}}),{target:x,eventName:"keydown"}),l.onKeyStroke(g,(e=>{const{altKey:a,ctrlKey:t,metaKey:l}=e;D.disabled||D.readonly||a||t||l||(te(e),ne(),B=!1,E("change",w.value))}),{target:x,eventName:"keyup"});const le=(e,a)=>{const{type:t}=e||{};if(!D.disabled&&!D.readonly){if(oe(e)&&"mousedown"===t&&e.button)return;ne(),a(1);const l=U.value,o=G.value,u=V.value,r=K.value;_=setTimeout((()=>{let e=0;k=setInterval((()=>{a(e<l?1:o),e++}),r)}),u)}},oe=e=>"mouseup"===e.type||"mousedown"===e.type,ue=e=>{oe(e)&&"mouseup"===e.type&&e.button||(te(e),ne(),re(!1),E("change",w.value))},re=e=>{try{a.eventOnOff(e,[document.body,"mouseup",ue,!1]),a.eventOnOff(e,[document.body,"touchend",ue,!1])}catch{}},ne=()=>{clearTimeout(_),clearInterval(k),_=void 0,k=void 0},ie=e.computed((()=>{const e={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-plus",viewBox:"0 0 16 16"},a={d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"},t={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-dash",viewBox:"0 0 16 16"},l={d:"M4 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 4 8z"},o={class:[{"py-0":!D.vertical},"btn","btn-sm","border-0","rounded-0"],tabindex:"-1",type:"button",disabled:D.disabled||D.readonly,"aria-disabled":!(!D.disabled&&!D.readonly)||void 0,"aria-controls":C.value},u={"aria-hidden":!0,scale:O.value?1.5:1.25},r=(e,a)=>{D.disabled||D.readonly||(te(e),re(!0),O.value=!0,le(e,a))},n={button:{...o,"aria-label":D.labelIncrement||void 0,"aria-keyshortcuts":"ArrowUp"},svg:{...u,...e},path:{...a},slot:{name:"increment"},handler:e=>r(e,ee)},i={button:{...o,"aria-label":D.labelDecrement||void 0,"aria-keyshortcuts":"ArrowDown"},svg:{...u,...t},path:{...l},slot:{name:"decrement"},handler:e=>r(e,ae)};return{top:{...D.vertical?n:i},bottom:{...D.vertical?i:n}}}));return(a,t)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"element",ref:x,class:e.normalizeClass(["b-form-spinbutton form-control",P.value]),role:"group",lang:J.value,tabindex:e.unref(D).disabled?void 0:"-1",title:e.unref(D).ariaLabel,onClick:t[4]||(t[4]=e=>O.value=!0)},[e.renderSlot(a.$slots,ie.value.top.slot.name,{hasFocus:e.unref(O)},(()=>[e.createElementVNode("button",e.mergeProps(ie.value.top.button,{onMousedown:t[0]||(t[0]=(...e)=>ie.value.top.handler&&ie.value.top.handler(...e)),onTouchstart:t[1]||(t[1]=(...e)=>ie.value.top.handler&&ie.value.top.handler(...e))}),[(e.openBlock(),e.createElementBlock("svg",e.normalizeProps(e.guardReactiveProps(ie.value.top.svg)),[e.createElementVNode("path",e.normalizeProps(e.guardReactiveProps(ie.value.top.path)),null,16)],16))],16)])),e.unref(D).name&&!e.unref(D).disabled?(e.openBlock(),e.createElementBlock("input",{key:"hidden",type:"hidden",name:e.unref(D).name,form:e.unref(D).form,value:$.value},null,8,d)):e.createCommentVNode("",!0),e.createElementVNode("output",{id:e.unref(C),key:"output",class:e.normalizeClass(["flex-grow-1",M.value]),dir:e.unref(H)?"rtl":"ltr",tabindex:e.unref(D).disabled?void 0:"0",role:"spinbutton","aria-live":"off","aria-label":e.unref(D).ariaLabel||void 0,"aria-invalid":!!(!1===e.unref(D).state||null!==!w.value&&e.unref(D).required)||void 0,"aria-required":!!e.unref(D).required||void 0,"aria-valuemin":F.value,"aria-valuemax":A.value,"aria-valuenow":null!==w.value?w.value:void 0,"aria-valuetext":null!==w.value?Q.value(w.value):void 0},[e.createElementVNode("bdi",null,e.toDisplayString((null!==w.value?Q.value(w.value):e.unref(D).placeholder)||""),1)],10,s),e.renderSlot(a.$slots,ie.value.bottom.slot.name,{hasFocus:e.unref(O)},(()=>[e.createElementVNode("button",e.mergeProps(ie.value.bottom.button,{onMousedown:t[2]||(t[2]=(...e)=>ie.value.bottom.handler&&ie.value.bottom.handler(...e)),onTouchstart:t[3]||(t[3]=(...e)=>ie.value.bottom.handler&&ie.value.bottom.handler(...e))}),[(e.openBlock(),e.createElementBlock("svg",e.normalizeProps(e.guardReactiveProps(ie.value.bottom.svg)),[e.createElementVNode("path",e.normalizeProps(e.guardReactiveProps(ie.value.bottom.path)),null,16)],16))],16)]))],10,i))}});exports._sfc_main=y;
//# sourceMappingURL=BFormSpinbutton.vue_vue_type_script_setup_true_lang-BLaiSQhU.js.map
